<html>
<head>
    <title>lms</title>

	<script
		type="text/javascript"
		src="https://code.jquery.com/jquery-3.3.1.min.js"
		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		crossorigin="anonymous"></script>
	<script
		type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"
		></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/jqtree/1.4.12/jqtree.css" rel="stylesheet" />
	<script
		type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jqtree/1.4.12/tree.jquery.js"
		></script>
	<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
	<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
	<script
		type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>

    <link href="/static/lmsapp.css" rel="stylesheet" />
    <script src="/static/rtx.js"></script>
	<script>
		var session = null;
		$(document).ready(function() {
			var root = $.cookie("rtx_prefix");
			if( root === undefined )
				window.location = "/login.html";
			session = RtxServer(root);
			session.sid = $.cookie("rtx_sid");
		});

		function search_submit() {
			params = {frag: $("#contact_bit").val()}
			session.get("api/personas/list", params, show_contact_results);
			return false;
		}

		function show_contact_results(content) {
			var table = content.main_table();

			if( table.length > 15 )
				$("#result-warning").append("<p>only showing 15 results</p>");
			else
				$("#result-warning").empty();

			table = table.slice(0, 15);

			var grid = $('#contact_data');
			grid.jsGrid({
				width: "60%",
				sorting: "true",
				data: table,
				fields: jsGrid_columns(content.main_table_columns())
			});
		}

	</script>
</head>
<body>
<div class="banner">
	<h1>lms</h1>
	<p id="userprof"></p>
</div>
<div class="tab-container">
	<a href="/contacts.html" class="tabopt" id="tabopt2">Contacts</a>
	<a href="/finances.html" class="tabopt" id="tabopt1">Finances</a>
	<a href="/application.html" class="tabopt" id="tabopt3">Application</a>
</div>

<form onsubmit="return search_submit();">
<table class="search">
	<tr>
		<td>Search: </td>
		<td><input type="text" id="contact_bit" /></td>
		<td><input type="submit" value="Search" /></td>
	</tr>
</table>
</form>

<div class="search_results" id="result-warning">
</div>

<div class="search_results" id="contact_data">
</div>


<div class="diag">
<h2>Diagnostics</h2>

<p>The <a href="/api/ping">ping endpoint</a> is not authenticated and is useful for
establishing basic connectivity and latency checks.</p>
</div>

</body>
</html>
